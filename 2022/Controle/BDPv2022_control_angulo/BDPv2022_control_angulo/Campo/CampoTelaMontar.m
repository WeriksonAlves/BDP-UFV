%% Inicia a tela de calibração de cores

% Inicia e modifica os parâmetros da tela de calibração e chama a função FecharCalibracao para fechar
Campo.ID = figure;

set(Campo.ID, ...
    'DockControls','off',...
    'Name','Calibração do Campo',...
    'Menubar','none',...
    'Toolbar','none',...
    'Renderer','OpenGL',...
    'NumberTitle','off',...
    'Resize','off',...
    'Visible','off',...
    'CloseRequestFcn','CampoTelaFechar',...
    'Position',[0.4 1 0.6 1].*BDP.DimTela([3 2 3 4]) + [0 50 0 -80],...
    'OuterPosition',[0.4 1 0.6 1].*BDP.DimTela([3 2 3 4]) + [0 50 0 -80]);

% ==============================================
% Calibração do Campo
Campo.Painel(1) = uipanel(Campo.ID,...
    'Title','Calibrar Campo',...
    'units','normalized',...
    'position',[0 0.7 1 0.3]);

% Cria os botões para segmentar as cores
Campo.Botoes(1) = uicontrol(Campo.Painel(1),'style','pushbutton','string','Capturar imagem'     ,'units','normalized','position',[0.05 0.7 0.24 0.25],'fontsize',09,'callback','CampoCapturarImagem'      ,'enable','off');
Campo.Botoes(2) = uicontrol(Campo.Painel(1),'style','pushbutton','string','Correlacionar pontos','units','normalized','position',[0.05 0.1 0.24 0.25],'fontsize',09,'callback','CampoCorrelacionarPontos' ,'enable','off');
Campo.Botoes(3) = uicontrol(Campo.Painel(1),'style','pushbutton','string','Validar pontos'      ,'units','normalized','position',[0.38 0.1 0.24 0.25],'fontsize',09,'callback','CampoValidarPontos'       ,'enable','off');
Campo.Botoes(4) = uicontrol(Campo.Painel(1),'style','pushbutton','string','Salvar Calibração'   ,'units','normalized','position',[0.70 0.1 0.24 0.25],'fontsize',09,'callback','CampoSalvar'              ,'enable','off');
Campo.Botoes(5) = uicontrol(Campo.Painel(1),'style','pushbutton','string','Recortar Imagem'     ,'units','normalized','position',[0.05 0.4 0.24 0.25],'fontsize',09,'callback','CampoRecortarFazer'       ,'enable','on');

% ==============================================
% Campo Padrão
Campo.Painel(2) = uipanel(Campo.ID,...
    'Title','Campo Padrão',...
    'units','normalized',...
    'position',[0 0.1 0.35 0.6]);

Campo.Padrao.ID = subplot(1,1,1,'parent',Campo.Painel(2));

% Desenho do Campo de Jogo
Campo.Padrao.Coord = [...
    -750 -650  750 -650;
    750 -650  750  650;
    750  650 -750  650;
    -750  650 -750 -650;
    000 -650  000  650;
    -750 -350 -600 -350;
    -600 -350 -600  350;
    -600  350 -750  350;
    750 -350  600 -350;
    600 -350  600  350;
    600  350  750  350];

Campo.Padrao.idPontos = [...
    -750 -650;
    000 -650;
    750 -650;
    750  650;
    000  650;
    -750  650;
    -600  350;
    -600 -350;
    600 -350;
    600  350];

Campo.Padrao.XY(:,:,1) = [-950  950  950 -950; -800 -800 800 800];
Campo.Padrao.XY(:,:,2) = [-750  000  000 -750; -650 -650 650 650];
Campo.Padrao.XY(:,:,3) = [ 000  750  750  000; -650 -650 650 650];
Campo.Padrao.XY(:,:,4) = [-750 -600 -600 -750; -350 -350 350 350];
Campo.Padrao.XY(:,:,5) = [ 600  750  750  600; -350 -350 350 350];

Campo.Padrao.fig(1) = patch(Campo.Padrao.XY(1,:,1),Campo.Padrao.XY(2,:,1),[0 0 0],'Parent',Campo.Padrao.ID,'EdgeColor',[0 0 0]);
for ii = 2:5
    Campo.Padrao.fig(ii) = patch(Campo.Padrao.XY(1,:,ii),Campo.Padrao.XY(2,:,ii),[0 0 0],'Parent',Campo.Padrao.ID,'EdgeColor',[1 1 1],'FaceAlpha',0);
end
axis equal
axis off


% ==============================================
% Campo Real
Campo.Painel(3) = uipanel(Campo.ID,...
    'Title','Campo Real',...
    'units','normalized',...
    'position',[0.36 0.1 0.64 0.6]);

Campo.Real.ID = subplot(1,1,1,'parent',Campo.Painel(3)); axis off

% ==============================================
% Log
Campo.Painel(4) = uipanel(Campo.ID,...
    'Title','Log',...
    'units','normalized',...
    'position',[0 0 1 0.1]);

Campo.status(1) = uicontrol(...
    'Style','text',...
    'String','',...
    'Parent',Campo.Painel(4),...
    'Units','normalized',...
    'HorizontalAlignment','Left',...
    'Position',[0.01 0.55 0.98 0.4],...
    'BackgroundColor',[0.2 0.2 0.2],...
    'ForegroundColor',[1 1 1],...
    'Visible','on','Enable','on');

Campo.status(2) = uicontrol(...
    'Style','text',...
    'String','',...
    'Parent',Campo.Painel(4),...
    'Units','normalized',...
    'HorizontalAlignment','Left',...
    'Position',[0.01 0.05 0.98 0.45],...
    'BackgroundColor',[0.8 0.8 0.8],...
    'ForegroundColor',[1 0 0],...
    'Visible','on','Enable','on');